<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>WOD & Progress Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="WOD Tracker">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    body {
      background: #020617;
      color: #e5e7eb;
      padding: 1.25rem;
    }

    .app {
      max-width: 960px;
      margin: 0 auto 3rem auto;
    }

    header {
      margin-bottom: 1.5rem;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 1rem;
      flex-wrap: wrap;
    }

    header-left {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .logo-wrap {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 42px;
      height: 42px;
      border-radius: 999px;
      background: radial-gradient(circle at 30% 20%, #22c55e, #16a34a 40%, #065f46 80%);
      box-shadow: 0 0 0 2px #022c22, 0 12px 25px rgba(0,0,0,0.6);
      flex-shrink: 0;
    }

    .logo-emoji {
      font-size: 1.3rem;
      transform: translateY(1px);
    }

    header h1 {
      font-size: 1.7rem;
      font-weight: 700;
    }

    header span {
      font-size: 0.9rem;
      color: #9ca3af;
      display: block;
    }

    .card {
      background: radial-gradient(circle at top left, #111827, #020617 55%);
      border-radius: 0.9rem;
      padding: 1.25rem 1.4rem;
      margin-bottom: 1rem;
      border: 1px solid #1f2937;
      box-shadow: 0 18px 45px rgba(0,0,0,0.45);
    }

    .card h2 {
      font-size: 1.1rem;
      margin-bottom: 0.75rem;
    }

    .wod-name {
      font-weight: 600;
      margin-bottom: 0.4rem;
      font-size: 1rem;
    }

    .wod-description {
      font-size: 0.95rem;
      color: #d1d5db;
      white-space: pre-line;
      margin-bottom: 0.75rem;
    }

    .tag {
      display: inline-block;
      font-size: 0.75rem;
      padding: 0.15rem 0.55rem;
      border-radius: 999px;
      border: 1px solid #4b5563;
      color: #9ca3af;
      margin-right: 0.25rem;
      margin-bottom: 0.25rem;
    }

    .tag-hero {
      border-color: #f97316;
      color: #fed7aa;
    }

    button,
    input,
    select,
    textarea {
      font: inherit;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 0.45rem 0.95rem;
      cursor: pointer;
      font-size: 0.9rem;
      background: linear-gradient(to right, #22c55e, #4ade80);
      color: #022c22;
      font-weight: 600;
      transition: transform 0.05s ease, box-shadow 0.05s ease, filter 0.1s ease;
      box-shadow: 0 12px 25px rgba(34,197,94,0.35);
      white-space: nowrap;
    }

    button.secondary {
      background: transparent;
      color: #e5e7eb;
      border: 1px solid #4b5563;
      box-shadow: none;
    }

    button.timer-main {
      width: 100%;
      justify-content: center;
    }

    button:active {
      transform: translateY(1px);
      box-shadow: none;
      filter: brightness(0.95);
    }

    button + button {
      margin-left: 0.5rem;
    }

    .wod-actions {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.5rem;
      margin-top: 0.75rem;
      flex-wrap: wrap;
    }

    label {
      font-size: 0.8rem;
      color: #9ca3af;
      display: block;
      margin-bottom: 0.25rem;
    }

    input[type="text"],
    input[type="date"],
    input[type="number"],
    select,
    textarea {
      width: 100%;
      padding: 0.55rem 0.65rem;
      border-radius: 0.6rem;
      border: 1px solid #4b5563;
      background: #020617;
      color: #e5e7eb;
      font-size: 0.9rem;
    }

    input::placeholder,
    textarea::placeholder {
      color: #6b7280;
    }

    textarea {
      min-height: 60px;
      resize: vertical;
    }

    .grid {
      display: grid;
      gap: 0.75rem;
    }

    @media (min-width: 768px) {
      .grid-2 {
        grid-template-columns: repeat(2, minmax(0, 1fr));
      }
      .grid-3 {
        grid-template-columns: repeat(3, minmax(0, 1fr));
      }
    }

    .log-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 0.75rem;
      flex-wrap: wrap;
      margin-bottom: 0.75rem;
    }

    .log-filters {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .log-filters input {
      max-width: 200px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.85rem;
      margin-top: 0.25rem;
      border-radius: 0.75rem;
      overflow: hidden;
    }

    th, td {
      padding: 0.45rem 0.4rem;
      border-bottom: 1px solid #111827;
      text-align: left;
      vertical-align: top;
    }

    th {
      font-weight: 600;
      color: #9ca3af;
      white-space: nowrap;
      background: #020617;
    }

    tr:nth-child(even) td {
      background: rgba(15,23,42,0.65);
    }

    tr:nth-child(odd) td {
      background: rgba(15,23,42,0.85);
    }

    tr:hover td {
      filter: brightness(1.05);
    }

    .empty {
      font-size: 0.85rem;
      color: #6b7280;
      padding: 0.5rem 0;
    }

    .pill {
      display: inline-block;
      padding: 0.1rem 0.45rem;
      border-radius: 999px;
      border: 1px solid #374151;
      font-size: 0.75rem;
      color: #9ca3af;
    }

    .pill-pr {
      border-color: #22c55e;
      color: #bbf7d0;
    }

    .small {
      font-size: 0.8rem;
      color: #6b7280;
    }

    .danger {
      color: #fca5a5;
    }

    .footer-note {
      margin-top: 0.5rem;
      font-size: 0.75rem;
      color: #6b7280;
      text-align: right;
    }

    .timer-display {
      font-size: 2rem;
      font-weight: 600;
      letter-spacing: 0.08em;
      text-align: center;
      margin-bottom: 0.5rem;
    }

    .timer-mode {
      display: inline-flex;
      border-radius: 999px;
      padding: 0.2rem;
      background: #020617;
      border: 1px solid #374151;
      margin-bottom: 0.6rem;
    }

    .timer-mode button {
      flex: 1;
      border-radius: 999px;
      padding: 0.25rem 0.7rem;
      font-size: 0.75rem;
      background: transparent;
      box-shadow: none;
      border: none;
      color: #9ca3af;
    }

    .timer-mode button.active {
      background: #22c55e;
      color: #022c22;
      box-shadow: 0 8px 18px rgba(34,197,94,0.35);
    }

    .timer-controls {
      display: flex;
      gap: 0.5rem;
      margin-top: 0.4rem;
      flex-wrap: wrap;
    }

    .timer-controls button {
      flex: 1;
      text-align: center;
    }

    .timer-inputs {
      display: flex;
      gap: 0.4rem;
      margin-bottom: 0.4rem;
      align-items: center;
      flex-wrap: wrap;
      justify-content: center;
    }

    .timer-inputs input {
      width: 4rem;
      text-align: center;
    }

    .timer-label {
      font-size: 0.75rem;
      color: #9ca3af;
      text-align: center;
      margin-bottom: 0.3rem;
    }
  </style>
</head>
<body>
  <div class="app">
    <header>
      <div style="display:flex;align-items:center;gap:0.75rem;flex-wrap:wrap;">
        <div class="logo-wrap">
          <span class="logo-emoji">üèãÔ∏è‚Äç‚ôÇÔ∏è</span>
        </div>
        <div>
          <h1>WOD & Progress Tracker</h1>
          <span>Random WOD, hero workouts, logging & PRs ‚Äì all local</span>
        </div>
      </div>
      <button class="secondary" id="clear-data-btn" title="This clears all your saved logs">
        Clear all data
      </button>
    </header>

    <!-- WOD of the Day -->
    <section class="card">
      <h2>Workout of the Day</h2>
      <div class="wod-name" id="wod-name"></div>
      <div class="wod-description" id="wod-description"></div>
      <div id="wod-tags"></div>

      <div class="wod-actions">
        <div class="small" id="wod-hint">
          Tap a WOD button or just log what you actually did below.
        </div>
        <div>
          <button id="random-wod-btn">New random WOD</button>
          <button class="secondary" id="hero-wod-btn">Hero WOD</button>
        </div>
      </div>
    </section>

    <!-- Timer -->
    <section class="card">
      <h2>Timer</h2>
      <div class="timer-mode">
        <button id="mode-stopwatch" class="active" type="button">Stopwatch</button>
        <button id="mode-countdown" type="button">Countdown</button>
      </div>

      <div class="timer-display" id="timer-display">00:00</div>

      <div class="timer-inputs" id="countdown-inputs" style="display:none;">
        <div>
          <div class="timer-label">Minutes</div>
          <input type="number" id="timer-minutes" min="0" max="999" value="10">
        </div>
        <div>
          <div class="timer-label">Seconds</div>
          <input type="number" id="timer-seconds" min="0" max="59" value="0">
        </div>
      </div>

      <div class="timer-controls">
        <button id="timer-start" type="button">Start</button>
        <button id="timer-pause" class="secondary" type="button">Pause</button>
        <button id="timer-reset" class="secondary" type="button">Reset</button>
      </div>

      <div style="margin-top:0.6rem;display:flex;gap:0.5rem;flex-wrap:wrap;">
        <button id="timer-to-log" class="secondary" type="button">
          Send time to log
        </button>
        <div class="small" style="flex:1;min-width:140px;">
          Use stopwatch for AMRAPs / for time. Countdown for EMOMs or caps.
        </div>
      </div>
    </section>

    <!-- Log performance -->
    <section class="card">
      <h2>Log your performance</h2>
      <form id="log-form">
        <div class="grid grid-3">
          <div>
            <label for="log-date">Date</label>
            <input type="date" id="log-date" required />
          </div>
          <div>
            <label for="log-workout-name">Workout name</label>
            <input type="text" id="log-workout-name" required placeholder="e.g. Fran, Heavy Squat, 10 Min AMRAP" />
          </div>
          <div>
            <label for="log-type">Type</label>
            <select id="log-type">
              <option value="For Time">For Time</option>
              <option value="AMRAP">AMRAP</option>
              <option value="Strength">Strength</option>
              <option value="EMOM">EMOM</option>
              <option value="Skill">Skill</option>
              <option value="Other" selected>Other</option>
            </select>
          </div>
        </div>

        <div class="grid grid-3" style="margin-top: 0.75rem;">
          <div>
            <label for="log-weight">Main weight (kg)</label>
            <input type="number" id="log-weight" step="0.5" min="0" placeholder="e.g. 80" />
          </div>
          <div>
            <label for="log-reps">Reps / rounds</label>
            <input type="text" id="log-reps" placeholder="e.g. 5x5, 7 rounds, 120 reps" />
          </div>
          <div>
            <label for="log-time">Time (mm:ss)</label>
            <input type="text" id="log-time" placeholder="e.g. 12:34" />
          </div>
        </div>

        <div style="margin-top: 0.75rem;">
          <label for="log-notes">Notes</label>
          <textarea id="log-notes" placeholder="How it felt, scaling, tweaks, PRs, etc."></textarea>
        </div>

        <div style="margin-top: 0.9rem; display: flex; justify-content: flex-end;">
          <button type="submit">Save entry</button>
        </div>
      </form>
    </section>

    <!-- History -->
    <section class="card">
      <div class="log-header">
        <h2>History & PRs</h2>
        <div class="log-filters">
          <input type="text" id="filter-text" placeholder="Filter by workout, notes, type..." />
          <button class="secondary" id="reset-filters-btn">Reset</button>
        </div>
      </div>

      <div id="history-container">
        <div class="empty">No entries yet. Log your first result above.</div>
      </div>

      <div class="footer-note">
        <span class="pill pill-pr" style="margin-right:0.3rem;">PR</span> = new best weight for that Strength workout.
        Data stays on this device.
      </div>
    </section>
  </div>

  <script>
    // ------- Sample WODs: including Hero workouts -------
    const WODS = [
      // Regular
      {
        name: "10 Min AMRAP",
        description: "10 minute AMRAP of:\n- 10 Kettlebell swings (24/16kg)\n- 10 Goblet squats\n- 50m run",
        tags: ["AMRAP", "Kettlebell", "Engine"]
      },
      {
        name: "Engine Builder",
        description: "For time:\n- 1km row\n- 50 sit-ups\n- 1km run/ski",
        tags: ["For Time", "Engine"]
      },
      {
        name: "Heavy Back Squat 5x5",
        description: "Back squat 5 sets of 5 reps\nBuild up to a heavy but tidy 5.",
        tags: ["Strength", "Squat", "Barbell"]
      },
      {
        name: "EMOM 12",
        description: "Every minute on the minute for 12 minutes:\nOdd minutes: 8 burpees\nEven minutes: 12 wall balls",
        tags: ["EMOM", "Conditioning"]
      },
      // Hero-style
      {
        name: "Murph (Partitioned)",
        description: "For time:\n- 1 mile run\n- 100 pull-ups\n- 200 push-ups\n- 300 air squats\n- 1 mile run\nPartition the reps as needed. Wear a weight vest if you usually do.",
        tags: ["Hero", "For Time", "Big Chipper"],
        hero: true
      },
      {
        name: "Fran",
        description: "21-15-9 reps for time of:\n- Thrusters (42.5/30kg)\n- Pull-ups",
        tags: ["Hero", "For Time", "Gas"],
        hero: true
      },
      {
        name: "Helen",
        description: "3 rounds for time of:\n- 400m run\n- 21 kettlebell swings (24/16kg)\n- 12 pull-ups",
        tags: ["Hero", "For Time", "Engine"],
        hero: true
      },
      {
        name: "DT",
        description: "5 rounds for time of:\n- 12 deadlifts (70/47.5kg)\n- 9 hang power cleans\n- 6 push jerks",
        tags: ["Hero", "For Time", "Barbell"],
        hero: true
      },
      {
        name: "Annie",
        description: "50-40-30-20-10 reps for time of:\n- Double-unders\n- Sit-ups",
        tags: ["Hero", "For Time", "Core"],
        hero: true
      }
    ];

    const STORAGE_KEY = "wodTrackerLogsV2";

    function getTodayString() {
      const d = new Date();
      const yyyy = d.getFullYear();
      const mm = String(d.getMonth() + 1).padStart(2, "0");
      const dd = String(d.getDate()).padStart(2, "0");
      return `${yyyy}-${mm}-${dd}`;
    }

    function loadLogs() {
      try {
        // Try new key first
        const raw = localStorage.getItem(STORAGE_KEY);
        if (raw) {
          const parsed = JSON.parse(raw);
          return Array.isArray(parsed) ? parsed : [];
        }
        // Fallback: migrate from old key if it exists
        const oldRaw = localStorage.getItem("wodTrackerLogsV1");
        if (!oldRaw) return [];
        const oldParsed = JSON.parse(oldRaw);
        const migrated = Array.isArray(oldParsed) ? oldParsed : [];
        saveLogs(migrated);
        return migrated;
      } catch (e) {
        console.error("Error loading logs", e);
        return [];
      }
    }

    function saveLogs(logs) {
      try {
        localStorage.setItem(STORAGE_KEY, JSON.stringify(logs));
      } catch (e) {
        console.error("Error saving logs", e);
      }
    }

    function randomWod() {
      return WODS[Math.floor(Math.random() * WODS.length)];
    }

    function heroWod() {
      const heroes = WODS.filter(w => w.hero);
      if (!heroes.length) return randomWod();
      return heroes[Math.floor(Math.random() * heroes.length)];
    }

    function setWod(wod) {
      const nameEl = document.getElementById("wod-name");
      const descEl = document.getElementById("wod-description");
      const tagsEl = document.getElementById("wod-tags");

      nameEl.textContent = wod.name;
      descEl.textContent = wod.description;

      tagsEl.innerHTML = "";
      if (wod.tags && wod.tags.length) {
        wod.tags.forEach(tag => {
          const span = document.createElement("span");
          span.className = "tag";
          if (tag.toLowerCase() === "hero") {
            span.classList.add("tag-hero");
          }
          span.textContent = tag;
          tagsEl.appendChild(span);
        });
      }

      const nameInput = document.getElementById("log-workout-name");
      if (!nameInput.value || nameInput.dataset.autofilled === "true") {
        nameInput.value = wod.name;
        nameInput.dataset.autofilled = "true";
      }
    }

    function formatDateHuman(isoDateString) {
      if (!isoDateString) return "";
      const [year, month, day] = isoDateString.split("-");
      if (!year || !month || !day) return isoDateString;
      const d = new Date(Number(year), Number(month) - 1, Number(day));
      if (isNaN(d.getTime())) return isoDateString;
      return d.toLocaleDateString(undefined, {
        year: "numeric",
        month: "short",
        day: "numeric"
      });
    }

    function renderHistory(logs, filterText = "") {
      const container = document.getElementById("history-container");
      container.innerHTML = "";

      let filtered = logs;
      if (filterText) {
        const lower = filterText.toLowerCase();
        filtered = logs.filter(
          l =>
            (l.workoutName && l.workoutName.toLowerCase().includes(lower)) ||
            (l.notes && l.notes.toLowerCase().includes(lower)) ||
            (l.type && l.type.toLowerCase().includes(lower))
        );
      }

      if (!filtered.length) {
        const div = document.createElement("div");
        div.className = "empty";
        div.textContent = logs.length
          ? "No entries match this filter."
          : "No entries yet. Log your first result above.";
        container.appendChild(div);
        return;
      }

      filtered = [...filtered].sort((a, b) => {
        if (a.date === b.date) {
          return (b.createdAt || 0) - (a.createdAt || 0);
        }
        return a.date < b.date ? 1 : -1;
      }).reverse(); // newest first

      const table = document.createElement("table");
      const thead = document.createElement("thead");
      thead.innerHTML = `
        <tr>
          <th>Date</th>
          <th>Workout</th>
          <th>Type</th>
          <th>Weight</th>
          <th>Reps / Rounds</th>
          <th>Time</th>
          <th>Notes</th>
        </tr>
      `;
      table.appendChild(thead);

      const tbody = document.createElement("tbody");
      filtered.forEach(log => {
        const tr = document.createElement("tr");
        const humanDate = formatDateHuman(log.date);
        const weightText = log.weight ? `${log.weight} kg` : "";
        const typePill = log.type
          ? `<span class="pill">${log.type}</span>`
          : "";
        const prPill = log.isPR
          ? `<span class="pill pill-pr" style="margin-left:0.25rem;">PR</span>`
          : "";
        tr.innerHTML = `
          <td>${humanDate}</td>
          <td>${log.workoutName || ""}</td>
          <td>${typePill}${prPill}</td>
          <td>${weightText}</td>
          <td>${log.reps || ""}</td>
          <td>${log.time || ""}</td>
          <td>${log.notes || ""}</td>
        `;
        tbody.appendChild(tr);
      });

      table.appendChild(tbody);
      container.appendChild(table);
    }

    // ---------- Timer logic ----------
    let timerMode = "stopwatch"; // or "countdown"
    let timerRunning = false;
    let timerValueMs = 0;
    let timerTargetMs = 0;
    let timerInterval = null;

    function msToMMSS(ms) {
      if (ms < 0) ms = 0;
      const totalSeconds = Math.floor(ms / 1000);
      const minutes = Math.floor(totalSeconds / 60);
      const seconds = totalSeconds % 60;
      return `${String(minutes).padStart(2, "0")}:${String(seconds).padStart(2, "0")}`;
    }

    function updateTimerDisplay() {
      const display = document.getElementById("timer-display");
      display.textContent = msToMMSS(timerValueMs);
    }

    function startTimer() {
      if (timerRunning) return;
      timerRunning = true;
      const tick = () => {
        if (!timerRunning) return;
        if (timerMode === "stopwatch") {
          timerValueMs += 200;
        } else {
          timerValueMs -= 200;
          if (timerValueMs <= 0) {
            timerValueMs = 0;
            timerRunning = false;
            clearInterval(timerInterval);
            alert("Time!");
          }
        }
        updateTimerDisplay();
      };
      timerInterval = setInterval(tick, 200);
    }

    function pauseTimer() {
      timerRunning = false;
      if (timerInterval) {
        clearInterval(timerInterval);
        timerInterval = null;
      }
    }

    function resetTimer() {
      pauseTimer();
      if (timerMode === "stopwatch") {
        timerValueMs = 0;
      } else {
        timerValueMs = timerTargetMs;
      }
      updateTimerDisplay();
    }

    function setCountdownFromInputs() {
      const min = parseInt(document.getElementById("timer-minutes").value || "0", 10);
      const sec = parseInt(document.getElementById("timer-seconds").value || "0", 10);
      const ms = (min * 60 + sec) * 1000;
      timerTargetMs = ms;
      timerValueMs = ms;
      updateTimerDisplay();
    }

    document.addEventListener("DOMContentLoaded", () => {
      const randomBtn = document.getElementById("random-wod-btn");
      const heroBtn = document.getElementById("hero-wod-btn");
      const logForm = document.getElementById("log-form");
      const clearBtn = document.getElementById("clear-data-btn");
      const filterInput = document.getElementById("filter-text");
      const resetFiltersBtn = document.getElementById("reset-filters-btn");
      const dateInput = document.getElementById("log-date");

      // Timer elements
      const modeStopwatchBtn = document.getElementById("mode-stopwatch");
      const modeCountdownBtn = document.getElementById("mode-countdown");
      const countdownInputs = document.getElementById("countdown-inputs");
      const timerStartBtn = document.getElementById("timer-start");
      const timerPauseBtn = document.getElementById("timer-pause");
      const timerResetBtn = document.getElementById("timer-reset");
      const timerToLogBtn = document.getElementById("timer-to-log");

      dateInput.value = getTodayString();

      let logs = loadLogs();
      renderHistory(logs);

      setWod(randomWod());

      randomBtn.addEventListener("click", () => {
        setWod(randomWod());
      });

      heroBtn.addEventListener("click", () => {
        setWod(heroWod());
      });

      logForm.addEventListener("submit", (e) => {
        e.preventDefault();
        const date = dateInput.value;
        const workoutNameEl = document.getElementById("log-workout-name");
        const workoutName = workoutNameEl.value.trim();
        const type = document.getElementById("log-type").value;
        const weightVal = document.getElementById("log-weight").value;
        const reps = document.getElementById("log-reps").value.trim();
        const time = document.getElementById("log-time").value.trim();
        const notes = document.getElementById("log-notes").value.trim();

        if (!date || !workoutName) {
          alert("Date and workout name are required.");
          return;
        }

        let numericWeight = null;
        if (weightVal) {
          const n = Number(weightVal);
          if (!isNaN(n)) numericWeight = n;
        }

        let isPR = false;
        if (type === "Strength" && numericWeight !== null) {
          const prevMax = logs
            .filter(l => l.type === "Strength" && l.workoutName === workoutName && l.weight != null)
            .reduce((max, l) => {
              const w = Number(l.weight) || 0;
              return w > max ? w : max;
            }, 0);
          if (numericWeight > prevMax) {
            isPR = true;
          }
        }

        const entry = {
          id: Date.now(),
          date,
          workoutName,
          type,
          weight: numericWeight,
          reps,
          time,
          notes,
          isPR,
          createdAt: Date.now()
        };

        logs.push(entry);
        saveLogs(logs);
        renderHistory(logs, filterInput.value.trim());

        document.getElementById("log-weight").value = "";
        document.getElementById("log-reps").value = "";
        document.getElementById("log-time").value = "";
        document.getElementById("log-notes").value = "";
        workoutNameEl.dataset.autofilled = "false";

        if (isPR) {
          alert("Nice! New PR recorded for " + workoutName + ".");
        }
      });

      clearBtn.addEventListener("click", () => {
        const sure = confirm("This will delete all saved logs in this browser on this device. Continue?");
        if (!sure) return;
        logs = [];
        saveLogs(logs);
        renderHistory(logs, filterInput.value.trim());
      });

      filterInput.addEventListener("input", () => {
        const text = filterInput.value.trim();
        renderHistory(logs, text);
      });

      resetFiltersBtn.addEventListener("click", () => {
        filterInput.value = "";
        renderHistory(logs, "");
      });

      // Timer wiring
      updateTimerDisplay();

      modeStopwatchBtn.addEventListener("click", () => {
        if (timerMode === "stopwatch") return;
        timerMode = "stopwatch";
        modeStopwatchBtn.classList.add("active");
        modeCountdownBtn.classList.remove("active");
        countdownInputs.style.display = "none";
        pauseTimer();
        timerValueMs = 0;
        updateTimerDisplay();
      });

      modeCountdownBtn.addEventListener("click", () => {
        if (timerMode === "countdown") return;
        timerMode = "countdown";
        modeCountdownBtn.classList.add("active");
        modeStopwatchBtn.classList.remove("active");
        countdownInputs.style.display = "flex";
        pauseTimer();
        setCountdownFromInputs();
      });

      document.getElementById("timer-minutes").addEventListener("change", setCountdownFromInputs);
      document.getElementById("timer-seconds").addEventListener("change", setCountdownFromInputs);

      timerStartBtn.addEventListener("click", () => {
        if (timerMode === "countdown") {
          setCountdownFromInputs();
        }
        startTimer();
      });

      timerPauseBtn.addEventListener("click", () => {
        pauseTimer();
      });

      timerResetBtn.addEventListener("click", () => {
        resetTimer();
      });

      timerToLogBtn.addEventListener("click", () => {
        const timeStr = msToMMSS(timerValueMs);
        document.getElementById("log-time").value = timeStr;
      });
    });
  </script>
</body>
</html>
